<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.2  (Unix)">
	<META NAME="CREATED" CONTENT="0;0">
	<META NAME="CHANGED" CONTENT="20101227;15100800">
	<STYLE TYPE="text/css">
	<!--
		@page { margin: 0.79in }
		P { margin-bottom: 0.08in }
		PRE { font-family: "Times New Roman" }
	-->
	</STYLE>
</HEAD>
<BODY LANG="el-GR" DIR="LTR">
<PRE> <FONT SIZE=5><SPAN LANG="en-US"><B>rk5na</B></SPAN></FONT>

<FONT SIZE=5><SPAN LANG="en-US">Solves an initial value problem for a system of first order ordinary differential equations </SPAN></FONT><FONT SIZE=5><SPAN LANG="en-US"><I>dy/dx=f(x,y)</I></SPAN></FONT><FONT SIZE=5><SPAN LANG="en-US"><SPAN STYLE="font-style: normal">, where f(x,y) may become large, e.g., in the neighborhood of a singularity, from </SPAN></SPAN></FONT><FONT SIZE=5><SPAN LANG="en-US"><I>x=x0 </I></SPAN></FONT><FONT SIZE=5><SPAN LANG="en-US"><SPAN STYLE="font-style: normal">to </SPAN></SPAN></FONT><FONT SIZE=5><SPAN LANG="en-US"><I>x=xe </I></SPAN></FONT><FONT SIZE=5><SPAN LANG="en-US"><SPAN STYLE="font-style: normal">where </SPAN></SPAN></FONT><FONT SIZE=5><SPAN LANG="en-US"><I>y(x0)=y0, </I></SPAN></FONT><FONT SIZE=5><SPAN LANG="en-US"><SPAN STYLE="font-style: normal">by means of a 5-th order Runge-Kutta method. The system is assumed to be nonstiff.</SPAN></SPAN></FONT>

<B><FONT SIZE=5><SPAN LANG="en-US"><SPAN STYLE="font-style: normal">Example: Can be run with F9 within the ScalaLab Editor  </SPAN></SPAN></FONT></B>



import java.text.DecimalFormat;
import numal.*;

public class Test_rk5na extends Object
                                implements AP_rk5na_methods {
        
        public static void main(String args[]) {

    boolean first;
    int j;
    double e[] = new double[6];
    double xa[] = new double[2];
    double x[] = new double[2];
    double d[] = new double[5];

    DecimalFormat eightDigit = new DecimalFormat(&quot;0.00000000&quot;);
    Test_rk5na testrk5na = new Test_rk5na();
    for (j=0; j&lt;=3; j++) e[j]=1.0e-6;
    e[4]=e[5]=1.0e-10;
    d[1]=0.0;
    xa[0]=2.0;  xa[1]=0.0;
    j=0;
    System.out.println(&quot;Results:\n    &quot; +
      &quot;x[0]           x[1]            s\n&quot; +
      &quot;  &quot; + eightDigit.format(xa[0]) + &quot;\t&quot; +
      eightDigit.format(xa[1]) + &quot;\t&quot; + 
      eightDigit.format(Math.abs(d[1])));
    do {
      first=(j == 0);
      Analytic_problems.rk5na(x,xa,testrk5na,e,d,first,1,1,false);
      j++;
      System.out.println(
        &quot;  &quot; + eightDigit.format(x[0]) + &quot;\t&quot; +
        eightDigit.format(x[1]) + &quot;\t&quot; + 
        eightDigit.format(Math.abs(d[1])));
    } while (j &lt; 4);
        }


  public double b(int n, double x[])
  {
    return x[1];
  }


  public double fxj(int n, int k, double x[])
  {
    return ((k == 0) ? x[1] : 10.0*(1.0-x[0]*x[0])*x[1]-x[0]); 
  }
}</PRE>
</BODY>
</HTML>